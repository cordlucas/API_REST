  services:
    api:
      container_name: api
      platform: "linux/amd64"
      build:
        context: "."
        dockerfile: ./Dockerfile
      links:
        - db
      depends_on:
        - db
      restart: on-failure
      ports:
        - 6000:5000

    db:
      container_name: db
      platform: "linux/amd64"
      image: mysql:8.0.27
      command: mysqld --default-authentication-plugin=mysql_native_password --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci
      environment:
        MYSQL_ROOT_PASSWORD: root
      ports:
        - '3306:3306'
      volumes:
        - './db/data:/var/lib/mysql'
        - './db/sql/init.sql:/docker-entrypoint-initdb.d/init.sql'